<!DOCTYPE html>
<html lang="sv">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orderdetaljer</title>
    <style>

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f7f7f7;
        }

        .container {
            display: flex;
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .main-content {
            flex: 2;
            padding-right: 20px;
        }

        .sidebar {
            flex: 1;
            background: #fff;
            padding: 20px;
            border-left: 1px solid #ddd;
        }

        .section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 5px;
        }

        h2 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .order-actions {
            margin-top: 10px;
        }

        .btn {
            display: inline-block;
            padding: 10px 15px;
            margin: 5px;
            background: #0073aa;
            color: white;
            text-decoration: none;
            border-radius: 5px;
        }

        .btn-danger {
            background: #d63638;
        }
    </style>
    <script>
    document.addEventListener('DOMContentLoaded', function () {

        //dom content loaded
        const order = {
        "id": 1824,
        "parent_id": 0,
        "status": "processing",
        "currency": "SEK",
        "version": "9.6.2",
        "prices_include_tax": false,
        "date_created": {
          "date": "2025-03-11 13:32:23.000000",
          "timezone_type": 1,
          "timezone": "+00:00"
        },
        "date_modified": {
          "date": "2025-03-11 13:32:39.000000",
          "timezone_type": 1,
          "timezone": "+00:00"
        },
        "discount_total": "22",
        "discount_tax": "5.5",
        "shipping_total": "49",
        "shipping_tax": "12.25",
        "cart_tax": "117.01",
        "total": "646.26",
        "total_tax": "129.26",
        "customer_id": 1,
        "order_key": "wc_order_uS5GzlvlnomCv",
        "billing": {
          "first_name": "bill",
          "last_name": "larsson",
          "company": "",
          "address_1": "stora huvudgatan 1",
          "address_2": "lgh 150",
          "city": "arvika",
          "state": "",
          "postcode": "671 31",
          "country": "SE",
          "email": "checkout-se@testdrive.klarna.com",
          "phone": "07200000001"
        },
        "shipping": {
          "first_name": "shippen",
          "last_name": "efternamn",
          "company": "",
          "address_1": "Lilla Tvärgatan 8",
          "address_2": "lgh 260",
          "city": "Löberöd",
          "state": "",
          "postcode": "241 62",
          "country": "SE",
          "phone": "07200000001"
        },
        "payment_method": "klarna_payments",
        "payment_method_title": "Klarna",
        "transaction_id": "ba979cda-df61-482d-99aa-8c42f59a5863",
        "customer_ip_address": "95.193.74.138",
        "customer_user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36",
        "created_via": "store-api",
        "customer_note": "",
        "date_completed": null,
        "date_paid": {
          "date": "2025-03-11 13:32:39.000000",
          "timezone_type": 1,
          "timezone": "+00:00"
        },
        "cart_hash": "12bc871ea093ea629f368f0d725dbd24",
        "order_stock_reduced": true,
        "download_permissions_granted": true,
        "new_order_email_sent": false,
        "recorded_sales": true,
        "recorded_coupon_usage_counts": true,
        "number": "kp-1379-demo",
        "meta_data": [
          {
            "id": 61849,
            "key": "_shipping_hash",
            "value": "9d4568c009d203ab10e33ea9953a0264"
          },
          {
            "id": 61850,
            "key": "_coupons_hash",
            "value": "61a15d404b99e1e93a0835d5b57e9a35"
          },
          {
            "id": 61851,
            "key": "_fees_hash",
            "value": "d751713988987e9331980363e24189ce"
          },
          {
            "id": 61852,
            "key": "_taxes_hash",
            "value": "32f72323a0fb0e3ebdd58203dc369e2f"
          },
          {
            "id": 61853,
            "key": "is_vat_exempt",
            "value": "no"
          },
          {
            "id": 61854,
            "key": "_order_total_base_currency",
            "value": "646.26"
          },
          {
            "id": 61855,
            "key": "_cart_discount_base_currency",
            "value": "22"
          },
          {
            "id": 61856,
            "key": "_order_shipping_base_currency",
            "value": "49"
          },
          {
            "id": 61857,
            "key": "_order_tax_base_currency",
            "value": "117.01"
          },
          {
            "id": 61858,
            "key": "_order_shipping_tax_base_currency",
            "value": "12.25"
          },
          {
            "id": 61859,
            "key": "_cart_discount_tax_base_currency",
            "value": "5.5"
          },
          {
            "id": 61860,
            "key": "_base_currency_exchange_rate",
            "value": "1"
          },
          {
            "id": 61933,
            "key": "_order_number",
            "value": "1379"
          },
          {
            "id": 61934,
            "key": "_order_number_formatted",
            "value": "kp-1379-demo"
          },
          {
            "id": 61935,
            "key": "_order_number_meta",
            "value": "1379"
          },
          {
            "id": 61936,
            "key": "_kp_session_data",
            "value": "{\"klarna_session\":{\"client_token\":\"eyJhbGciOiJSUzI1NiIsImtpZCI6IjgyMzA1ZWJjLWI4MTEtMzYzNy1hYTRjLTY2ZWNhMTg3NGYzZCJ9.eyJzZXNzaW9uX2lkIjoiMGViMDYyODYtZDY1My02MDg3LWI2ZjAtNWJiYzk3MzRiYTRmIiwiYmFzZV91cmwiOiJodHRwczovL2pzLnBsYXlncm91bmQua2xhcm5hLmNvbS9ldS9rcCIsImRlc2lnbiI6ImtsYXJuYSIsImxhbmd1YWdlIjoiZW4iLCJwdXJjaGFzZV9jb3VudHJ5IjoiU0UiLCJlbnZpcm9ubWVudCI6InBsYXlncm91bmQiLCJtZXJjaGFudF9uYW1lIjoiUGxheWdyb3VuZCBEZW1vIE1lcmNoYW50Iiwic2Vzc2lvbl90eXBlIjoiUEFZTUVOVFMiLCJjbGllbnRfZXZlbnRfYmFzZV91cmwiOiJodHRwczovL2V1LnBsYXlncm91bmQua2xhcm5hZXZ0LmNvbSIsInNjaGVtZSI6dHJ1ZSwiZXhwZXJpbWVudHMiOlt7Im5hbWUiOiJrcGMtcHNlbC00NDI5IiwidmFyaWF0ZSI6ImEifSx7Im5hbWUiOiJrcC1jbGllbnQtb25lLXB1cmNoYXNlLWZsb3ciLCJ2YXJpYXRlIjoidmFyaWF0ZS0xIn0seyJuYW1lIjoia3BjLTFrLXNlcnZpY2UiLCJ2YXJpYXRlIjoidmFyaWF0ZS0xIn0seyJuYW1lIjoia3AtY2xpZW50LXV0b3BpYS1zdGF0aWMtd2lkZ2V0IiwidmFyaWF0ZSI6ImluZGV4IiwicGFyYW1ldGVycyI6eyJkeW5hbWljIjoidHJ1ZSJ9fSx7Im5hbWUiOiJrcC1jbGllbnQtdXRvcGlhLWZsb3ciLCJ2YXJpYXRlIjoidmFyaWF0ZS0xIn0seyJuYW1lIjoiaW4tYXBwLXNkay1uZXctaW50ZXJuYWwtYnJvd3NlciIsInBhcmFtZXRlcnMiOnsidmFyaWF0ZV9pZCI6Im5ldy1pbnRlcm5hbC1icm93c2VyLWVuYWJsZSJ9fSx7Im5hbWUiOiJrcC1jbGllbnQtdXRvcGlhLXNkay1mbG93IiwidmFyaWF0ZSI6InZhcmlhdGUtMSJ9LHsibmFtZSI6ImtwLWNsaWVudC11dG9waWEtd2Vidmlldy1mbG93IiwidmFyaWF0ZSI6InZhcmlhdGUtMSJ9LHsibmFtZSI6ImluLWFwcC1zZGstY2FyZC1zY2FubmluZyIsInBhcmFtZXRlcnMiOnsidmFyaWF0ZV9pZCI6ImNhcmQtc2Nhbm5pbmctZW5hYmxlIn19XSwicmVnaW9uIjoiZXUiLCJvcmRlcl9hbW91bnQiOjM2NTAxLCJvZmZlcmluZ19vcHRzIjoyLCJvbyI6ImQyIiwidmVyc2lvbiI6InYxLjEwLjAtMTU5MC1nM2ViYzM5MDciLCJpIjoiYnQifQ.YitSuevIt9DtHLdesux_FAoqJThiEwoPvBK4fBAsPI5wKkDGs5EqnHcW6UzvUzAbVZKyzQycuPnDr8WLw5FpDSbTzaLASBQUEUF4I_aWXhUV0ueQyf2XpN2reRBJsS5tllZVnBsUN_A7UboxntoYzUcOM2GKNInw8dI-T2AZVER1BhXLtBeIeWQaRWjLcyrpj_Stdl2JhG7derf9gC9A2rjQ9NeotpXH2NMGoJmLDhKrzcbn5UeLZh6dASSSga_h2fvjjRXawagd86lie28hyUFFxA90qd_4nqc2DiK-vAaDInvWcNwdJq4Hhqann9j0IY1PA11nls7JzziyN9RibA\",\"payment_method_categories\":[{\"asset_urls\":{\"descriptive\":\"https:\\/\\/x.klarnacdn.net\\/payment-method\\/assets\\/badges\\/generic\\/klarna.svg\",\"standard\":\"https:\\/\\/x.klarnacdn.net\\/payment-method\\/assets\\/badges\\/generic\\/klarna.svg\"},\"identifier\":\"pay_over_time\",\"name\":\"Monthly financing\"},{\"asset_urls\":{\"descriptive\":\"https:\\/\\/x.klarnacdn.net\\/payment-method\\/assets\\/badges\\/generic\\/klarna.svg\",\"standard\":\"https:\\/\\/x.klarnacdn.net\\/payment-method\\/assets\\/badges\\/generic\\/klarna.svg\"},\"identifier\":\"pay_now\",\"name\":\"Pay now\"},{\"asset_urls\":{\"descriptive\":\"https:\\/\\/x.klarnacdn.net\\/payment-method\\/assets\\/badges\\/generic\\/klarna.svg\",\"standard\":\"https:\\/\\/x.klarnacdn.net\\/payment-method\\/assets\\/badges\\/generic\\/klarna.svg\"},\"identifier\":\"pay_later\",\"name\":\"Buy now, pay later\"}],\"session_id\":\"0eb06286-d653-6087-b6f0-5bbc9734ba4f\"},\"session_hash\":\"9fee15b88dc0b7bf43b7b08e80757a51\",\"session_country\":\"SE\",\"session_locale\":\"en_US\"}"
          },
          {
            "id": 61937,
            "key": "_wc_klarna_environment",
            "value": "test"
          },
          {
            "id": 61938,
            "key": "_wc_klarna_country",
            "value": "SE"
          },
          {
            "id": 61939,
            "key": "_kp_session_id",
            "value": "0eb06286-d653-6087-b6f0-5bbc9734ba4f"
          },
          {
            "id": 61943,
            "key": "_wc_klarna_order_id",
            "value": "ba979cda-df61-482d-99aa-8c42f59a5863"
          },
          {
            "id": 61944,
            "key": "_krokedil_environment_info",
            "value": {
              "php_version": "8.3.16",
              "wc_version": "9.6.2",
              "wp_version": "6.7.2",
              "plugin_version": "4.0.0"
            }
          },
          {
            "id": 61945,
            "key": "_ppu_upsell_ids",
            "value": [
              "fbfe661c-a872-4ac2-9b1b-9baad9380b36"
            ]
          }
        ],
        "line_items": {
          "7965": {
            "id": 7965,
            "order_id": 1824,
            "name": "Water bottle",
            "product_id": 38,
            "variation_id": 0,
            "quantity": 1,
            "tax_class": "",
            "subtotal": "35",
            "subtotal_tax": "8.75",
            "total": "27.67",
            "total_tax": "6.92",
            "taxes": {
              "total": {
                "26": "6.9175"
              },
              "subtotal": {
                "26": "8.75"
              }
            },
            "meta_data": [
              {
                "id": 65697,
                "key": "_line_subtotal_base_currency",
                "value": "35"
              },
              {
                "id": 65699,
                "key": "_line_subtotal_tax_base_currency",
                "value": "8.75"
              },
              {
                "id": 65701,
                "key": "_line_total_base_currency",
                "value": "27.67"
              },
              {
                "id": 65703,
                "key": "_line_tax_base_currency",
                "value": "6.92"
              }
            ]
          },
          "7966": {
            "id": 7966,
            "order_id": 1824,
            "name": "T-Shirt",
            "product_id": 15,
            "variation_id": 0,
            "quantity": 1,
            "tax_class": "",
            "subtotal": "150",
            "subtotal_tax": "37.5",
            "total": "142.66",
            "total_tax": "35.67",
            "taxes": {
              "total": {
                "26": "35.665"
              },
              "subtotal": {
                "26": "37.5"
              }
            },
            "meta_data": [
              {
                "id": 65710,
                "key": "_line_subtotal_base_currency",
                "value": "150"
              },
              {
                "id": 65712,
                "key": "_line_subtotal_tax_base_currency",
                "value": "37.5"
              },
              {
                "id": 65714,
                "key": "_line_total_base_currency",
                "value": "142.66"
              },
              {
                "id": 65716,
                "key": "_line_tax_base_currency",
                "value": "35.67"
              }
            ]
          },
          "7967": {
            "id": 7967,
            "order_id": 1824,
            "name": "Liniment subscription",
            "product_id": 293,
            "variation_id": 0,
            "quantity": 1,
            "tax_class": "",
            "subtotal": "80",
            "subtotal_tax": "20",
            "total": "72.67",
            "total_tax": "18.17",
            "taxes": {
              "total": {
                "26": "18.1675"
              },
              "subtotal": {
                "26": "20"
              }
            },
            "meta_data": [
              {
                "id": 65723,
                "key": "_line_subtotal_base_currency",
                "value": "80"
              },
              {
                "id": 65725,
                "key": "_line_subtotal_tax_base_currency",
                "value": "20"
              },
              {
                "id": 65727,
                "key": "_line_total_base_currency",
                "value": "72.67"
              },
              {
                "id": 65729,
                "key": "_line_tax_base_currency",
                "value": "18.17"
              }
            ]
          },
          "7979": {
            "id": 7979,
            "order_id": 1824,
            "name": "Zip-hood",
            "product_id": 263,
            "variation_id": 0,
            "quantity": 1,
            "tax_class": "",
            "subtotal": "225",
            "subtotal_tax": "56.25",
            "total": "225",
            "total_tax": "56.25",
            "taxes": {
              "total": {
                "26": "56.25"
              },
              "subtotal": {
                "26": "56.25"
              }
            },
            "meta_data": [
              {
                "id": 65812,
                "key": "_line_subtotal_base_currency",
                "value": "225"
              },
              {
                "id": 65814,
                "key": "_line_subtotal_tax_base_currency",
                "value": "56.25"
              },
              {
                "id": 65816,
                "key": "_line_total_base_currency",
                "value": "225"
              },
              {
                "id": 65818,
                "key": "_line_tax_base_currency",
                "value": "56.25"
              },
              {
                "id": 65821,
                "key": "_ppu_upsell_id",
                "value": "fbfe661c-a872-4ac2-9b1b-9baad9380b36"
              }
            ]
          }
        },
        "tax_lines": {
          "7973": {
            "id": 7973,
            "order_id": 1824,
            "name": "",
            "rate_code": "SE-VAT SE-1",
            "rate_id": 26,
            "label": "VAT SE",
            "compound": false,
            "tax_total": "117.01",
            "shipping_tax_total": "12.25",
            "rate_percent": 25,
            "meta_data": [
              {
                "id": 65765,
                "key": "tax_amount_base_currency",
                "value": "117.01"
              },
              {
                "id": 65767,
                "key": "shipping_tax_amount_base_currency",
                "value": "12.25"
              }
            ]
          }
        },
        "shipping_lines": {
          "7974": {
            "id": 7974,
            "order_id": 1824,
            "name": "Flat rate",
            "method_title": "Flat rate",
            "method_id": "flat_rate",
            "instance_id": "3",
            "total": "49.00",
            "total_tax": "12.25",
            "taxes": {
              "total": {
                "26": "12.25"
              }
            },
            "tax_status": "taxable",
            "meta_data": [
              {
                "id": 65775,
                "key": "Items",
                "value": "Water bottle &times; 1, T-Shirt &times; 1, Liniment subscription &times; 1"
              }
            ]
          }
        },
        "fee_lines": [],
        "coupon_lines": {
          "7975": {
            "id": 7975,
            "order_id": 1824,
            "name": "",
            "code": "martins-kupong-kod",
            "discount": "22",
            "discount_tax": "5.5",
            "meta_data": [
              {
                "id": 65776,
                "key": "discount_amount_base_currency",
                "value": "22"
              },
              {
                "id": 65778,
                "key": "discount_amount_tax_base_currency",
                "value": "5.5"
              },
              {
                "id": 65780,
                "key": "coupon_info",
                "value": "[1823,\"martins-kupong-kod\",null,22]"
              }
            ]
          }
        },
        "order_comments": [
          {
            "id": 711,
            "date_created": {
              "date": "2025-03-11 13:32:48.000000",
              "timezone_type": 1,
              "timezone": "+00:00"
            },
            "content": "The customer added <i>Zip-hood</i> to the order through an upsell offer",
            "customer_note": false,
            "added_by": "system",
            "order_id": 1824
          },
          {
            "id": 710,
            "date_created": {
              "date": "2025-03-11 13:32:39.000000",
              "timezone_type": 1,
              "timezone": "+00:00"
            },
            "content": "The Klarna order was successfully completed",
            "customer_note": false,
            "added_by": "system",
            "order_id": 1824
          },
          {
            "id": 709,
            "date_created": {
              "date": "2025-03-11 13:32:39.000000",
              "timezone_type": 1,
              "timezone": "+00:00"
            },
            "content": "Payment via Klarna Payments, order ID: ba979cda-df61-482d-99aa-8c42f59a5863",
            "customer_note": false,
            "added_by": "system",
            "order_id": 1824
          },
          {
            "id": 706,
            "date_created": {
              "date": "2025-03-11 13:32:39.000000",
              "timezone_type": 1,
              "timezone": "+00:00"
            },
            "content": "Order status changed from Pending payment to Processing.",
            "customer_note": false,
            "added_by": "system",
            "order_id": 1824
          },
          {
            "id": 705,
            "date_created": {
              "date": "2025-03-11 13:32:23.000000",
              "timezone_type": 1,
              "timezone": "+00:00"
            },
            "content": "Order status changed from Draft to Pending payment.",
            "customer_note": false,
            "added_by": "system",
            "order_id": 1824
          }
        ]
      }
    
      console.log(order)

    let orderLines = Object.values(order.line_items).map(line => `                    <tr>
                        <td>${line.name}</td>
                        <td>${line.subtotal}</td>
                        <td>${line.quantity}</td>
                        <td>${line.total}</td>
                        <td>${line.total_tax}</td>
                    </tr>`)
                    
      let couponLines = Object.values(order.coupon_lines).map(coupon => `
                <td>${coupon.id}</td>
                <td>${coupon.order_id}</td>
                <td>${coupon.code}</td>
                <td>${coupon.discount}</td>
                <td>${coupon.discount_tax}</td>
                <td>
                    <ul>
                        ${coupon.meta_data.map(meta => `<li>${meta.key}: ${meta.value}</li>`).join('')}
                    </ul>
                </td>
            `
        );
        console.log('couponLines', couponLines)

let metaData = Object.values(order.meta_data.map(d => 
`            <tr>
                <td>${d.key}</td>
                <td>${d.value}</td>
            </tr>`))

let orderNotes = Object.values(order.order_comments).map(order_comment => `
            <div class="section">
                <p>${order_comment.content}</p>
                <p>Added by: ${order_comment.added_by}</p>
                <p>${order_comment.date_created.date}</p>
                ${order_comment.customer_note ? '<p>Customer Note</p>' : ''}
            </div>`)


    let templeteString = `<div class="container">
        <div class="main-content">
            <div class="section">
                <h2>Order #${order.id} ${order.number}</h2>
                <p><strong>Betalning via ${order.payment_method}. Transaction ID</strong> (: ${order.transaction_id})</p>
                <p><strong>Date paid:</strong> ${order.date_paid.date}</p>
                <p><strong>Status:</strong> ${order.status}</p>
            </div>
            <div class="section">
                <h2>Billing</h2>
                <p><strong>Company:</strong> ${order.billing.company}</p>
                <p><strong>Namn:</strong> ${order.billing.first_name} ${order.billing.last_name}</p>
                <p><strong>Adress:</strong> ${order.billing.address_1} ${order.billing.address_2}, ${order.billing.postcode} ${order.billing.city}</p>
                <p><strong>Email:</strong> ${order.billing.email}</p>
                <p><strong>Telefon:</strong> ${order.billing.phone}</p>
            </div>
            <div class="section">
                <h2>Shipping</h2>
                <p><strong>Namn:</strong> ${order.shipping.first_name} ${order.shipping.last_name}</p>
                <p><strong>Adress:</strong> ${order.shipping.address_1} ${order.shipping.address_2}, ${order.shipping.postcode} ${order.shipping.city}</p>
                <p><strong>Telefon:</strong> ${order.shipping.phone}</p>
            </div>
            <div class="section">
                <h2>Orderdetaljer</h2>
                <table>
                    <tr>
                        <th>Namn</th>
                        <th>Kostnad</th>
                        <th>Antal</th>
                        <th>Total</th>
                        <th>VAT</th>
                    </tr>
                    ${orderLines}
                </table>
        <table border="1">
          <thead>
              <tr>
                  <th>Kupong ID</th>
                  <th>Order ID</th>
                  <th>Kod</th>
                  <th>Rabatt</th>
                  <th>Rabatt Skatt</th>
                  <th>Meta Data</th>
              </tr>
          </thead>
          <tbody id="couponTableBody">
          ${couponLines}
          </tbody>
        </table>
                <p><strong>Frakt:</strong> ${order.shipping_total} kr</p>
                <p><strong>Moms:</strong> ${order.total_tax}</p>
                <p><strong>Totalt: ${order.total}</strong></p>
            </div>
        </div>
        <div class="sidebar">
            <h2>Ordernoteringar</h2>
        ${orderNotes}
        </div>
    </div>
    <div class="section">
        <h2>Custom Fields</h2>
        <table>
            <tr>
                <th>Key</th>
                <th>Value</th>
            </tr>
            ${metaData}
        </table>
    </div>
    </div>
`
// use innerhtml to display the order details
document.body.innerHTML = templeteString
})
</script>
</head>

<body>
</body>